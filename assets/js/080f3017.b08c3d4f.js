"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[5014],{3905:function(e,t,n){n.d(t,{Zo:function(){return d},kt:function(){return m}});var a=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=a.createContext({}),p=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},d=function(e){var t=p(e.components);return a.createElement(s.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,i=e.originalType,s=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),u=p(n),m=o,g=u["".concat(s,".").concat(m)]||u[m]||c[m]||i;return n?a.createElement(g,r(r({ref:t},d),{},{components:n})):a.createElement(g,r({ref:t},d))}));function m(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=n.length,r=new Array(i);r[0]=u;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:o,r[1]=l;for(var p=2;p<i;p++)r[p]=n[p];return a.createElement.apply(null,r)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},8044:function(e,t,n){n.r(t),n.d(t,{assets:function(){return d},contentTitle:function(){return s},default:function(){return m},frontMatter:function(){return l},metadata:function(){return p},toc:function(){return c}});var a=n(3117),o=n(102),i=(n(7294),n(3905)),r=["components"],l={},s="Deploying on DigitalOcean App Platform",p={unversionedId:"how-to/deploying-on-digital-ocean",id:"how-to/deploying-on-digital-ocean",title:"Deploying on DigitalOcean App Platform",description:"This is a guide for deploying a Adminfirstly project on DigitalOcean App Platform.",source:"@site/../../docs/content/how-to/deploying-on-digital-ocean.md",sourceDirName:"how-to",slug:"/how-to/deploying-on-digital-ocean",permalink:"/how-to/deploying-on-digital-ocean",editUrl:"https://github.com/medusajs/medusa/edit/master/www/../../docs/content/how-to/deploying-on-digital-ocean.md",tags:[],version:"current",frontMatter:{}},d={},c=[{value:"1. Configure Adminfirstly",id:"1-configure-adminfirstly",level:3},{value:"Update <code>adminfirstly-config.js</code>",id:"update-adminfirstly-configjs",level:4},{value:"Update <code>package.json</code>",id:"update-packagejson",level:4},{value:"Push changes to your repository",id:"push-changes-to-your-repository",level:4},{value:"2. DigitalOcean",id:"2-digitalocean",level:3},{value:"3. Create an App",id:"3-create-an-app",level:3},{value:"4. Connect you Git repository",id:"4-connect-you-git-repository",level:3},{value:"5. Configure environment variables",id:"5-configure-environment-variables",level:3},{value:"6. Set up a Database",id:"6-set-up-a-database",level:3},{value:"7. Give your app a name",id:"7-give-your-app-a-name",level:3},{value:"8. Finalize the setup",id:"8-finalize-the-setup",level:3},{value:"9. Add a Redis Database",id:"9-add-a-redis-database",level:3},{value:"10. Configure Redis for your App",id:"10-configure-redis-for-your-app",level:3},{value:"11. Deploy Adminfirstly",id:"11-deploy-adminfirstly",level:3},{value:"12. Try it out!",id:"12-try-it-out",level:3},{value:"What&#39;s next?",id:"whats-next",level:3}],u={toc:c};function m(e){var t=e.components,n=(0,o.Z)(e,r);return(0,i.kt)("wrapper",(0,a.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"deploying-on-digitalocean-app-platform"},"Deploying on DigitalOcean App Platform"),(0,i.kt)("p",null,"This is a guide for deploying a Adminfirstly project on DigitalOcean App Platform."),(0,i.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"It is assumed, that you are currently running a local instance of Adminfirstly. If not, check out our ",(0,i.kt)("a",{parentName:"p",href:"https://docs.adminfirstly.com/quickstart/quick-start"},"Quickstart")," or use ",(0,i.kt)("inlineCode",{parentName:"p"},"npx create-adminfirstly-app")," to set up your application in a matter of minutes. For the latter, see ",(0,i.kt)("a",{parentName:"p",href:"https://docs.adminfirstly.com/how-to/create-adminfirstly-app"},"this guide")," for a small walkthrough."))),(0,i.kt)("h3",{id:"1-configure-adminfirstly"},"1. Configure Adminfirstly"),(0,i.kt)("p",null,"Before jumping into DigitalOcean, your Adminfirstly application needs to be configured."),(0,i.kt)("h4",{id:"update-adminfirstly-configjs"},"Update ",(0,i.kt)("inlineCode",{parentName:"h4"},"adminfirstly-config.js")),(0,i.kt)("p",null,"Instead of using a single environment variable for the database, ",(0,i.kt)("inlineCode",{parentName:"p"},"DATABASE_URL"),", set ",(0,i.kt)("inlineCode",{parentName:"p"},"DB_*")," variables and declare ",(0,i.kt)("inlineCode",{parentName:"p"},"DATABASE_URL")," like so:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript="},"const DB_USERNAME = process.env.DB_USERNAME;\nconst DB_PASSWORD = process.env.DB_PASSWORD;\nconst DB_HOST = process.env.DB_HOST;\nconst DB_PORT = process.env.DB_PORT;\nconst DB_DATABASE = process.env.DB_DATABASE;\n\nconst DATABASE_URL = `postgres://${DB_USERNAME}:${DB_PASSWORD}@${DB_HOST}:${DB_PORT}/${DB_DATABASE}`;\n\n")),(0,i.kt)("p",null,"Update ",(0,i.kt)("inlineCode",{parentName:"p"},"module.exports")," to include the following:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript="},'module.exports = {\n  projectConfig: {\n    redis_url: REDIS_URL,\n    database_url: DATABASE_URL,\n    database_type: "postgres",\n    store_cors: STORE_CORS,\n    admin_cors: ADMIN_CORS,\n    database_extra: { ssl: { rejectUnauthorized: false } }\n  },\n  plugins,\n};\n')),(0,i.kt)("h4",{id:"update-packagejson"},"Update ",(0,i.kt)("inlineCode",{parentName:"h4"},"package.json")),(0,i.kt)("p",null,"Update ",(0,i.kt)("inlineCode",{parentName:"p"},"scripts")," to have the following:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json="},'...\n"scripts": {\n    "serve": "adminfirstly start",\n    "start": "adminfirstly migrations run && adminfirstly develop",\n    "build": "babel src -d dist --extensions \\".ts,.js\\""\n}\n...\n')),(0,i.kt)("p",null,"Add a newer version of node to ",(0,i.kt)("inlineCode",{parentName:"p"},"engines"),":"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json="},'...\n"engines": {\n    "node": "14.x"\n}\n...\n')),(0,i.kt)("h4",{id:"push-changes-to-your-repository"},"Push changes to your repository"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-shell="},'git add .\ngit commit -m "chore: DigitalOcean setup"\ngit push origin master\n')),(0,i.kt)("h3",{id:"2-digitalocean"},"2. ",(0,i.kt)("a",{parentName:"h3",href:"https://cloud.digitalocean.com/login"},"DigitalOcean")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://cloud.digitalocean.com/login"},"Sign in")," to your DigitalOcean Account or ",(0,i.kt)("a",{parentName:"p",href:"https://cloud.digitalocean.com/registrations/new"},"create a new one"),"."),(0,i.kt)("h3",{id:"3-create-an-app"},"3. Create an App"),(0,i.kt)("p",null,"Navigate to the top-right dropdown ",(0,i.kt)("strong",{parentName:"p"},"Create")," and select ",(0,i.kt)("strong",{parentName:"p"},"Apps"),"."),(0,i.kt)("h3",{id:"4-connect-you-git-repository"},"4. Connect you Git repository"),(0,i.kt)("p",null,"Choose ",(0,i.kt)("strong",{parentName:"p"},"GitHub")," or ",(0,i.kt)("strong",{parentName:"p"},"GitLab")," and select the repository that holds your Adminfirstly project. Check ",(0,i.kt)("strong",{parentName:"p"},"Autodeploy code changes"),", if you want DigitalOcean to deploy on every push to your repository."),(0,i.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"It's important, that DigitalOcean is pointing to the directory holding the Adminfirstly store engine as it is only this which that will be deployed (If you followed the quickstart guide this will simply be the created project, and if you used the npx command this will be the backend folder inside of the newly created project)."))),(0,i.kt)("h3",{id:"5-configure-environment-variables"},"5. Configure environment variables"),(0,i.kt)("p",null,"The default settings for your app should be sufficient. We only need to change environment variables to hold the following:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-shell="},"DB_USERNAME=${db.USERNAME}\nDB_PASSWORD=${db.PASSWORD}\nDB_HOST=${db.HOSTNAME}\nDB_PORT=${db.PORT}\nDB_DATABASE=${db.DATABASE}\nREDIS_URL=${redis.DATABASE_URL}\nJWT_SECRET=your-jwt-secret\nCOOKIE_SECRET=your-cookie-secret\n")),(0,i.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"Make sure to use actual secrets in a production environment"))),(0,i.kt)("h3",{id:"6-set-up-a-database"},"6. Set up a Database"),(0,i.kt)("p",null,"Click ",(0,i.kt)("strong",{parentName:"p"},"Add a Database"),". If you named your database instance something different than ",(0,i.kt)("inlineCode",{parentName:"p"},"db"),", make sure your environment variable reflect this. See our use of ",(0,i.kt)("inlineCode",{parentName:"p"},"db")," below."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-shell="},"DB_USERNAME=${db.USERNAME}\n")),(0,i.kt)("h3",{id:"7-give-your-app-a-name"},"7. Give your app a name"),(0,i.kt)("p",null,"Enter a name for your app and select the most suitable region for your setup."),(0,i.kt)("h3",{id:"8-finalize-the-setup"},"8. Finalize the setup"),(0,i.kt)("p",null,"Choose a plan for your App. For just getting started, the Basic plan should be sufficient. For a production environment, the ",(0,i.kt)("strong",{parentName:"p"},"Pro plan")," is recommended."),(0,i.kt)("p",null,"Finally, launch the app."),(0,i.kt)("h3",{id:"9-add-a-redis-database"},"9. Add a Redis Database"),(0,i.kt)("p",null,"The following steps will add a Redis database to your Adminfirstly setup."),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Navigate to the top-right dropdown ",(0,i.kt)("strong",{parentName:"li"},"Create")," and select ",(0,i.kt)("strong",{parentName:"li"},"Databases")),(0,i.kt)("li",{parentName:"ol"},"Select ",(0,i.kt)("strong",{parentName:"li"},"Redis")),(0,i.kt)("li",{parentName:"ol"},"Select the same region you chose for your App"),(0,i.kt)("li",{parentName:"ol"},"Leave VPC Network as it is"),(0,i.kt)("li",{parentName:"ol"},"Choose a name for your Redis Database")),(0,i.kt)("p",null,"Similarly to our other database, if you choose to name Redis something different than ",(0,i.kt)("inlineCode",{parentName:"p"},"redis"),", you should udpdate the environment variable as well. See our use of ",(0,i.kt)("inlineCode",{parentName:"p"},"redis")," below."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-shell="},"REDIS_URL=${redis.DATABASE_URL}\n")),(0,i.kt)("ol",{start:6},(0,i.kt)("li",{parentName:"ol"},"Create the Redis database for your project")),(0,i.kt)("h3",{id:"10-configure-redis-for-your-app"},"10. Configure Redis for your App"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"In the navbar on the left, click ",(0,i.kt)("strong",{parentName:"li"},"Apps")," and select your Adminfirstly App"),(0,i.kt)("li",{parentName:"ol"},"Select ",(0,i.kt)("strong",{parentName:"li"},"Settings")," \u279c ",(0,i.kt)("strong",{parentName:"li"},"Add component")," \u279c ",(0,i.kt)("strong",{parentName:"li"},"Database")),(0,i.kt)("li",{parentName:"ol"},"Select ",(0,i.kt)("strong",{parentName:"li"},"Previously Created DigitalOcean Database")),(0,i.kt)("li",{parentName:"ol"},"Select the Redis Cluster created in the previous step")),(0,i.kt)("h3",{id:"11-deploy-adminfirstly"},"11. Deploy Adminfirstly"),(0,i.kt)("p",null,"If you haven't already, make sure to rebuild and deploy your Adminfirstly App."),(0,i.kt)("h3",{id:"12-try-it-out"},"12. Try it out!"),(0,i.kt)("p",null,"In DigitalOcean, navigate to your App overview and access your endpoint to try out your new setup."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"https://your-endpoint.ondigitalocean.app/health\n")),(0,i.kt)("h3",{id:"whats-next"},"What's next?"),(0,i.kt)("p",null,"You now have an application running on DigitalOcean. This can be scaled and configured to fit your business needs."),(0,i.kt)("p",null,"Furthermore, you can deploy a Adminfirstly Admin for your application, such that you can start managing your store from an interface."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://docs.adminfirstly.com/how-to/deploying-admin-on-netlify"},"Deploy Admin on Netlify")),(0,i.kt)("li",{parentName:"ul"},"Deploy Admin on Gatsby Cloud (Coming soon)")))}m.isMDXComponent=!0}}]);