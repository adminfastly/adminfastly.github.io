"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[2422],{3905:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return m}});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var u=a.createContext({}),s=function(e){var t=a.useContext(u),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},c=function(e){var t=s(e.components);return a.createElement(u.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,u=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),d=s(n),m=r,f=d["".concat(u,".").concat(m)]||d[m]||p[m]||o;return n?a.createElement(f,l(l({ref:t},c),{},{components:n})):a.createElement(f,l({ref:t},c))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,l=new Array(o);l[0]=d;var i={};for(var u in t)hasOwnProperty.call(t,u)&&(i[u]=t[u]);i.originalType=e,i.mdxType="string"==typeof e?e:r,l[1]=i;for(var s=2;s<o;s++)l[s]=n[s];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},8215:function(e,t,n){n.d(t,{Z:function(){return r}});var a=n(7294);function r(e){var t=e.children,n=e.hidden,r=e.className;return a.createElement("div",{role:"tabpanel",hidden:n,className:r},t)}},3736:function(e,t,n){n.d(t,{Z:function(){return p}});var a=n(7294),r=n(3117),o=n(2389),l=n(3342),i=n(6010),u="tabItem_LplD";function s(e){var t,n,o,s=e.lazy,c=e.block,p=e.defaultValue,d=e.values,m=e.groupId,f=e.className,v=a.Children.map(e.children,(function(e){if((0,a.isValidElement)(e)&&void 0!==e.props.value)return e;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})),h=null!=d?d:v.map((function(e){var t=e.props;return{value:t.value,label:t.label,attributes:t.attributes}})),y=(0,l.lx)(h,(function(e,t){return e.value===t.value}));if(y.length>0)throw new Error('Docusaurus error: Duplicate values "'+y.map((function(e){return e.value})).join(", ")+'" found in <Tabs>. Every value needs to be unique.');var g=null===p?p:null!=(t=null!=p?p:null==(n=v.find((function(e){return e.props.default})))?void 0:n.props.value)?t:null==(o=v[0])?void 0:o.props.value;if(null!==g&&!h.some((function(e){return e.value===g})))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+g+'" but none of its children has the corresponding value. Available values are: '+h.map((function(e){return e.value})).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");var k=(0,l.UB)(),b=k.tabGroupChoices,w=k.setTabGroupChoices,N=(0,a.useState)(g),S=N[0],E=N[1],O=[],T=(0,l.o5)().blockElementScrollPositionUntilNextRender;if(null!=m){var A=b[m];null!=A&&A!==S&&h.some((function(e){return e.value===A}))&&E(A)}var I=function(e){var t=e.currentTarget,n=O.indexOf(t),a=h[n].value;a!==S&&(T(t),E(a),null!=m&&w(m,a))},j=function(e){var t,n=null;switch(e.key){case"ArrowRight":var a=O.indexOf(e.currentTarget)+1;n=O[a]||O[0];break;case"ArrowLeft":var r=O.indexOf(e.currentTarget)-1;n=O[r]||O[O.length-1]}null==(t=n)||t.focus()};return a.createElement("div",{className:"tabs-container"},a.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,i.Z)("tabs",{"tabs--block":c},f)},h.map((function(e){var t=e.value,n=e.label,o=e.attributes;return a.createElement("li",(0,r.Z)({role:"tab",tabIndex:S===t?0:-1,"aria-selected":S===t,key:t,ref:function(e){return O.push(e)},onKeyDown:j,onFocus:I,onClick:I},o,{className:(0,i.Z)("tabs__item",u,null==o?void 0:o.className,{"tabs__item--active":S===t})}),null!=n?n:t)}))),s?(0,a.cloneElement)(v.filter((function(e){return e.props.value===S}))[0],{className:"margin-vert--md"}):a.createElement("div",{className:"margin-vert--md"},v.map((function(e,t){return(0,a.cloneElement)(e,{key:t,hidden:e.props.value!==S})}))))}function c(e){var t=(0,o.Z)();return a.createElement(s,(0,r.Z)({key:String(t)},e))}function p(e){return(0,a.useEffect)((function(){window.localStorage.getItem("docusaurus.tab.npm2yarn")||window.localStorage.setItem("docusaurus.tab.npm2yarn","yarn")}),[]),a.createElement(a.Fragment,null,a.createElement(c,e))}},537:function(e,t,n){n.r(t),n.d(t,{assets:function(){return d},contentTitle:function(){return c},default:function(){return v},frontMatter:function(){return s},metadata:function(){return p},toc:function(){return m}});var a=n(3117),r=n(102),o=(n(7294),n(3905)),l=n(3736),i=n(8215),u=["components"],s={},c="S3",p={unversionedId:"add-plugins/s3",id:"add-plugins/s3",title:"S3",description:"In order to work with images in Adminfirstly, you need a file service plugin responsible for hosting. Following this guide will allow you to upload images to AWS S3.",source:"@site/../../docs/content/add-plugins/s3.md",sourceDirName:"add-plugins",slug:"/add-plugins/s3",permalink:"/add-plugins/s3",editUrl:"https://github.com/medusajs/medusa/edit/master/www/../../docs/content/add-plugins/s3.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"MinIO",permalink:"/add-plugins/minio"},next:{title:"Spaces",permalink:"/add-plugins/spaces"}},d={},m=[{value:"Before you start",id:"before-you-start",level:3},{value:"Set up AWS",id:"set-up-aws",level:3},{value:"Create an S3 bucket",id:"create-an-s3-bucket",level:4},{value:"Generate access keys",id:"generate-access-keys",level:4},{value:"Installation",id:"installation",level:3},{value:"Try it out",id:"try-it-out",level:3}],f={toc:m};function v(e){var t=e.components,n=(0,r.Z)(e,u);return(0,o.kt)("wrapper",(0,a.Z)({},f,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"s3"},"S3"),(0,o.kt)("p",null,"In order to work with images in Adminfirstly, you need a file service plugin responsible for hosting. Following this guide will allow you to upload images to AWS S3."),(0,o.kt)("h3",{id:"before-you-start"},"Before you start"),(0,o.kt)("p",null,"At this point, you should have an instance of our store engine running. If not, we have a ",(0,o.kt)("a",{parentName:"p",href:"https://docs.adminfirstly.com/tutorial/set-up-your-development-environment"},"full guide")," for setting up your local environment."),(0,o.kt)("h3",{id:"set-up-aws"},"Set up AWS"),(0,o.kt)("h4",{id:"create-an-s3-bucket"},"Create an S3 bucket"),(0,o.kt)("p",null,'In the AWS console navigate to S3 and create a bucket for your images. Make sure to uncheck "Block ',(0,o.kt)("em",{parentName:"p"},"all"),' public access".'),(0,o.kt)("p",null,"Additionally, you need to add a policy to your bucket, that will allow public access to objects that are uploaded. Navigate to the permissions tab of your bucket and add the following policy:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell="},'{\n  "Id": "Policy1397632521960",\n  "Statement": [\n    {\n      "Sid": "Stmt1397633323327",\n      "Action": [\n        "s3:GetObject"\n      ],\n      "Effect": "Allow",\n      "Resource": "arn:aws:s3:::YOUR-BUCKET-NAME/*",\n      "Principal": {\n        "AWS": [\n          "*"\n        ]\n      }\n    }\n  ]\n}\n')),(0,o.kt)("p",null,"Be aware, that this will allow for anyone to acces your bucket. Avoid storing sensitive data."),(0,o.kt)("h4",{id:"generate-access-keys"},"Generate access keys"),(0,o.kt)("p",null,"Navigate to the IAM section of your AWS console and perform the following steps:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Add a new user with programmatic access"),(0,o.kt)("li",{parentName:"ul"},"Add the existing ",(0,o.kt)("strong",{parentName:"li"},"AmazonS3FullAccess")," policy to the user"),(0,o.kt)("li",{parentName:"ul"},"Submit the details")),(0,o.kt)("p",null,"Upon successfull creation of the user, you are presented with an ",(0,o.kt)("strong",{parentName:"p"},"Access key ID")," and a ",(0,o.kt)("strong",{parentName:"p"},"Secret access key"),". Note both of them down for later use."),(0,o.kt)("h3",{id:"installation"},"Installation"),(0,o.kt)("p",null,"First, install the plugin using your preferred package manager:"),(0,o.kt)(l.Z,{groupId:"npm2yarn",mdxType:"Tabs"},(0,o.kt)(i.Z,{value:"npm",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"npm install adminfirstly-file-s3\n"))),(0,o.kt)(i.Z,{value:"yarn",label:"Yarn",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"yarn add adminfirstly-file-s3\n")))),(0,o.kt)("p",null,"Then configure your ",(0,o.kt)("inlineCode",{parentName:"p"},"adminfirstly-config.js")," to include the plugin alongside the required options:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-=javascript"},'{\n    resolve: `adminfirstly-file-s3`,\n    options: {\n        s3_url: "https://s3-guide-test.s3.eu-west-1.amazonaws.com",\n        bucket: "test",\n        region: "eu-west-1"\n        access_key_id: "YOUR-ACCESS-KEY",\n        secret_access_key: "YOUR-SECRET-KEY",\n    },\n},\n')),(0,o.kt)("p",null,"In the above options, an ",(0,o.kt)("inlineCode",{parentName:"p"},"s3_url")," is included. The url has the following format:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell="},"https://[bucket].s3.[region].amazonaws.com\n")),(0,o.kt)("p",null,"The two access keys in the options are the ones created in the previous section."),(0,o.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"}," Make sure to use an environment variable for the secret key in a live environment."))),(0,o.kt)("h3",{id:"try-it-out"},"Try it out"),(0,o.kt)("p",null,"Finally, run your Adminfirstly server alongside our admin system to try out your new file service. Upon editing or creating products, you can now upload thumbnails and images, that are stored in an AWS S3 bucket."))}v.isMDXComponent=!0}}]);