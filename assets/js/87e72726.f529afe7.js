"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[1276],{3905:function(e,t,n){n.d(t,{Zo:function(){return d},kt:function(){return m}});var o=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,o,a=function(e,t){if(null==e)return{};var n,o,a={},r=Object.keys(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var u=o.createContext({}),s=function(e){var t=o.useContext(u),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},d=function(e){var t=s(e.components);return o.createElement(u.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},p=o.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,u=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),p=s(n),m=a,h=p["".concat(u,".").concat(m)]||p[m]||c[m]||r;return n?o.createElement(h,i(i({ref:t},d),{},{components:n})):o.createElement(h,i({ref:t},d))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,i=new Array(r);i[0]=p;var l={};for(var u in t)hasOwnProperty.call(t,u)&&(l[u]=t[u]);l.originalType=e,l.mdxType="string"==typeof e?e:a,i[1]=l;for(var s=2;s<r;s++)i[s]=n[s];return o.createElement.apply(null,i)}return o.createElement.apply(null,n)}p.displayName="MDXCreateElement"},8215:function(e,t,n){n.d(t,{Z:function(){return a}});var o=n(7294);function a(e){var t=e.children,n=e.hidden,a=e.className;return o.createElement("div",{role:"tabpanel",hidden:n,className:a},t)}},3736:function(e,t,n){n.d(t,{Z:function(){return c}});var o=n(7294),a=n(3117),r=n(2389),i=n(3342),l=n(6010),u="tabItem_LplD";function s(e){var t,n,r,s=e.lazy,d=e.block,c=e.defaultValue,p=e.values,m=e.groupId,h=e.className,f=o.Children.map(e.children,(function(e){if((0,o.isValidElement)(e)&&void 0!==e.props.value)return e;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})),g=null!=p?p:f.map((function(e){var t=e.props;return{value:t.value,label:t.label,attributes:t.attributes}})),y=(0,i.lx)(g,(function(e,t){return e.value===t.value}));if(y.length>0)throw new Error('Docusaurus error: Duplicate values "'+y.map((function(e){return e.value})).join(", ")+'" found in <Tabs>. Every value needs to be unique.');var k=null===c?c:null!=(t=null!=c?c:null==(n=f.find((function(e){return e.props.default})))?void 0:n.props.value)?t:null==(r=f[0])?void 0:r.props.value;if(null!==k&&!g.some((function(e){return e.value===k})))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+k+'" but none of its children has the corresponding value. Available values are: '+g.map((function(e){return e.value})).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");var w=(0,i.UB)(),v=w.tabGroupChoices,b=w.setTabGroupChoices,N=(0,o.useState)(k),x=N[0],T=N[1],C=[],j=(0,i.o5)().blockElementScrollPositionUntilNextRender;if(null!=m){var A=v[m];null!=A&&A!==x&&g.some((function(e){return e.value===A}))&&T(A)}var R=function(e){var t=e.currentTarget,n=C.indexOf(t),o=g[n].value;o!==x&&(j(t),T(o),null!=m&&b(m,o))},P=function(e){var t,n=null;switch(e.key){case"ArrowRight":var o=C.indexOf(e.currentTarget)+1;n=C[o]||C[0];break;case"ArrowLeft":var a=C.indexOf(e.currentTarget)-1;n=C[a]||C[C.length-1]}null==(t=n)||t.focus()};return o.createElement("div",{className:"tabs-container"},o.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,l.Z)("tabs",{"tabs--block":d},h)},g.map((function(e){var t=e.value,n=e.label,r=e.attributes;return o.createElement("li",(0,a.Z)({role:"tab",tabIndex:x===t?0:-1,"aria-selected":x===t,key:t,ref:function(e){return C.push(e)},onKeyDown:P,onFocus:R,onClick:R},r,{className:(0,l.Z)("tabs__item",u,null==r?void 0:r.className,{"tabs__item--active":x===t})}),null!=n?n:t)}))),s?(0,o.cloneElement)(f.filter((function(e){return e.props.value===x}))[0],{className:"margin-vert--md"}):o.createElement("div",{className:"margin-vert--md"},f.map((function(e,t){return(0,o.cloneElement)(e,{key:t,hidden:e.props.value!==x})}))))}function d(e){var t=(0,r.Z)();return o.createElement(s,(0,a.Z)({key:String(t)},e))}function c(e){return(0,o.useEffect)((function(){window.localStorage.getItem("docusaurus.tab.npm2yarn")||window.localStorage.setItem("docusaurus.tab.npm2yarn","yarn")}),[]),o.createElement(o.Fragment,null,o.createElement(d,e))}},9008:function(e,t,n){n.r(t),n.d(t,{assets:function(){return p},contentTitle:function(){return d},default:function(){return f},frontMatter:function(){return s},metadata:function(){return c},toc:function(){return m}});var o=n(3117),a=n(102),r=(n(7294),n(3905)),i=n(3736),l=n(8215),u=["components"],s={title:"Making your store more powerful with Contentful"},d="Making your store more powerful with Contentful",c={unversionedId:"how-to/making-your-store-more-powerful-with-contentful",id:"how-to/making-your-store-more-powerful-with-contentful",title:"Making your store more powerful with Contentful",description:"In part 1 of this series you have set up Adminfirstly with Contentful as your CMS system and added a Gatsby storefront. In this part you will get a further introduction to Contentful and learn how adminfirstly-plugin-contentful can be leveraged to make your store more powerful. Apart from a front page, product pages and a checkout flow, most ecommerce stores also need miscalleneous pages like About and Contact pages. In this guide you will add a Rich Text content module to your Contentful space so that you can make this pages cool. You will also see how the content modules can be used to give your product pages more life.",source:"@site/../../docs/content/how-to/making-your-store-more-powerful-with-contentful.md",sourceDirName:"how-to",slug:"/how-to/making-your-store-more-powerful-with-contentful",permalink:"/how-to/making-your-store-more-powerful-with-contentful",editUrl:"https://github.com/medusajs/medusa/edit/master/www/../../docs/content/how-to/making-your-store-more-powerful-with-contentful.md",tags:[],version:"current",frontMatter:{title:"Making your store more powerful with Contentful"},sidebar:"tutorialSidebar",previous:{title:"Create a headless ecommerce store with Gatsby, Contentful & Adminfirstly",permalink:"/how-to/headless-ecommerce-store-with-gatsby-contentful-medusa"},next:{title:"sendgrid",permalink:"/add-plugins/sendgrid"}},p={},m=[{value:"Creating a rich text content module",id:"creating-a-rich-text-content-module",level:2},{value:"Adding Rich Text to About",id:"adding-rich-text-to-about",level:2},{value:"Updating the storefront to support the Rich Text module",id:"updating-the-storefront-to-support-the-rich-text-module",level:2},{value:"Enriching your Product pages",id:"enriching-your-product-pages",level:2},{value:"Migrating Products",id:"migrating-products",level:3},{value:"Adding &quot;Related Products&quot; Tile Section",id:"adding-related-products-tile-section",level:3},{value:"Adding Content Modules to Product pages",id:"adding-content-modules-to-product-pages",level:2},{value:"Summary",id:"summary",level:2},{value:"What&#39;s next",id:"whats-next",level:2}],h={toc:m};function f(e){var t=e.components,n=(0,a.Z)(e,u);return(0,r.kt)("wrapper",(0,o.Z)({},h,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"making-your-store-more-powerful-with-contentful"},"Making your store more powerful with Contentful"),(0,r.kt)("p",null,"In ",(0,r.kt)("a",{parentName:"p",href:"https://docs.adminfirstly.com/how-to/headless-ecommerce-store-with-gatsby-contentful-adminfirstly/"},"part 1")," of this series you have set up ",(0,r.kt)("a",{parentName:"p",href:"https://adminfirstly.com"},"Adminfirstly")," with Contentful as your CMS system and added a Gatsby storefront. In this part you will get a further introduction to Contentful and learn how ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/adminfirstly/adminfirstly/tree/master/packages/adminfirstly-plugin-contentful"},(0,r.kt)("inlineCode",{parentName:"a"},"adminfirstly-plugin-contentful"))," can be leveraged to make your store more powerful. Apart from a front page, product pages and a checkout flow, most ecommerce stores also need miscalleneous pages like About and Contact pages. In this guide you will add a Rich Text content module to your Contentful space so that you can make this pages cool. You will also see how the content modules can be used to give your product pages more life."),(0,r.kt)("p",null,"What you will do in this guide:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Add a rich text content module"),(0,r.kt)("li",{parentName:"ul"},"Add rich text to your ",(0,r.kt)("inlineCode",{parentName:"li"},"/about")," page"),(0,r.kt)("li",{parentName:"ul"},'Add a "Related Products" section to your product page')),(0,r.kt)("p",null,"Topics covered:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Contentful Migrations"),(0,r.kt)("li",{parentName:"ul"},"Product enrichment")),(0,r.kt)("h2",{id:"creating-a-rich-text-content-module"},"Creating a rich text content module"),(0,r.kt)("p",null,"In this guide you will make use of ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/contentful/contentful-migration"},"Contentful Migrations")," to keep a versioned controlled record of how your Content evolves over time. The Contentful app allows you to create content models straight from their dashboard, however, when using the migrations tool you will be able to 1) quickly replicate your Contentful space and 2) incorporate migrations as part of a CI/CD pipeline. ",(0,r.kt)("a",{parentName:"p",href:"https://www.contentful.com/help/cms-as-code/"},"You can read more about how to use CMS as Code here"),"."),(0,r.kt)("p",null,"To prepare your migration create a new file at ",(0,r.kt)("inlineCode",{parentName:"p"},"contentful-migrations/rich-text.js")," and add the following code:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},'// contentful-migrations/rich-text.js\n\nmodule.exports = function (migration, context) {\n  const richText = migration\n    .createContentType("richText")\n    .name("Rich Text")\n    .displayField("title")\n\n  richText.createField("title").name("Title (Internal)").type("Symbol")\n  richText.createField("body").name("Body").type("RichText")\n}\n')),(0,r.kt)("p",null,"This small snippet will create a content model in your Contentful space with two fields: a title which will be used to name entries in a meaningful manner (i.e. it won't be displayed to customers) and a body which contains the rich text to display. To apply your migration run:"),(0,r.kt)(i.Z,{groupId:"npm2yarn",mdxType:"Tabs"},(0,r.kt)(l.Z,{value:"npm",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"npm run migrate:contentful --file contentful-migrations/rich-text.js\n"))),(0,r.kt)(l.Z,{value:"yarn",label:"Yarn",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"yarn run migrate:contentful --file contentful-migrations/rich-text.js\n")))),(0,r.kt)("p",null,"If you go to your Contentful space and click Content Model you will see that the Rich Text model has been added to your space:\n",(0,r.kt)("img",{parentName:"p",src:"https://i.imgur.com/sCMjr4B.png",alt:null})),(0,r.kt)("p",null,"The validation rules in the Page model only allow Hero and Tile Sections to be added to the Content Modules fields so you will need another migration to make it possible for pages to make use of the new Rich Text modules. Create a new migration at ",(0,r.kt)("inlineCode",{parentName:"p"},"contentful-migrations/update-page-module-validation.js")," and add the following:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},'// contentful-migrations/update-page-module-validation.js\n\nmodule.exports = function (migration, context) {\n  const page = migration.editContentType("page")\n\n  page.editField("contentModules").items({\n    type: "Link",\n    linkType: "Entry",\n    validations: [\n      {\n        linkContentType: ["hero", "tileSection", "richText"],\n      },\n    ],\n  })\n}\n')),(0,r.kt)("p",null,"After migrating your space you are ready create your new contact page:"),(0,r.kt)(i.Z,{groupId:"npm2yarn",mdxType:"Tabs"},(0,r.kt)(l.Z,{value:"npm",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"npm run migrate:contentful --file contentful-migrations/update-page-module-validation.js\n"))),(0,r.kt)(l.Z,{value:"yarn",label:"Yarn",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"yarn run migrate:contentful --file contentful-migrations/update-page-module-validation.js\n")))),(0,r.kt)("h2",{id:"adding-rich-text-to-about"},"Adding Rich Text to About"),(0,r.kt)("p",null,"To use your new Rich Text module ",(0,r.kt)("strong",{parentName:"p"},"Content > Page > About"),", and click ",(0,r.kt)("strong",{parentName:"p"},"Add Content > Page"),". You will now make use of the new Rich Text module to add some more details about your store. You can write your own text or use the text provided below if you just want to copy/paste."),(0,r.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"About Adminfirstly")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"}," Adminfirstly is an open-source headless commerce engine for fast-growing businesses. Getting started with Adminfirstly is very easy and you will be able to start selling online with a basic setup in no time, however, the real power of Adminfirstly starts showing up when you add custom functionality and extend your core to fit your needs."),(0,r.kt)("p",{parentName:"div"}," The core Adminfirstly package and all the official Adminfirstly plugins ship as individual NPM packages that you install into a Node project. You store and plugins are configured in your adminfirstly-config.js file making it very easy to manage your store as your business grows. Custom functionality doesn't have to come from plugins, you can also add project-level functionality by simply adding files in your ",(0,r.kt)("inlineCode",{parentName:"p"},"src/")," folder. Adminfirstly will automatically register your custom functionalities in the bootstrap phase."))),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://i.imgur.com/hqiaoFq.png",alt:null})),(0,r.kt)("p",null,"When you have added your text you can click ",(0,r.kt)("strong",{parentName:"p"},"Publish changes")," (make sure the About page is published too)."),(0,r.kt)("h2",{id:"updating-the-storefront-to-support-the-rich-text-module"},"Updating the storefront to support the Rich Text module"),(0,r.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"}," If you want to jump straight to the final frontend code visit ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/adminfirstly/adminfirstly-contentful-storefront/tree/part-2"},"adminfirstly/adminfirstly-contentful-storefront@part-2"),"."))),(0,r.kt)("p",null,"To display your newly created Rich Text module open up the storefront code and create a new file at ",(0,r.kt)("inlineCode",{parentName:"p"},"src/components/rich-text/rich-text.jsx"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},'// src/components/rich-text/rich-text.jsx\n\nimport React from "react"\nimport { renderRichText } from "gatsby-source-contentful/rich-text"\n\nimport * as styles from "../../styles/rich-text.module.css"\n\nconst RichText = ({ data }) => {\n  return (\n    <div className={styles.container}>\n      <div className={styles.content}>\n        {data.body ? renderRichText(data.body) : ""}\n      </div>\n    </div>\n  )\n}\n\nexport default RichText\n')),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"renderRichText")," function is imported from the ",(0,r.kt)("inlineCode",{parentName:"p"},"gatsby-source-contentful")," plugin to easily transform the text you entered in the Rich Text module to html. To make the Rich Text component render nicely add a style file as well at ",(0,r.kt)("inlineCode",{parentName:"p"},"src/styles/rich-text.module.css"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-css"},"/* src/styles/rich-text.module.css */\n\n.container {\n  display: flex;\n  padding-top: 100px;\n  padding-bottom: 100px;\n}\n\n.content {\n  margin: auto;\n  max-width: 870px;\n}\n")),(0,r.kt)("p",null,"If you restart your storefront server now you will not be able to see your new Rich Text module just yet. The last step to making that happen will be to let the Page component know to render the new Rich Text component when it encounters Rich Text in the Page's Content Modules. In your editor open up the file ",(0,r.kt)("inlineCode",{parentName:"p"},"src/pages/{ContentfulPage.slug}.js")," and add the following:"),(0,r.kt)("p",null,"At the top of the file import your ",(0,r.kt)("inlineCode",{parentName:"p"},"RichText")," component:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},'...\nimport RichText from "../components/rich-text/rich-text"\n...\n')),(0,r.kt)("p",null,"Now in the ",(0,r.kt)("inlineCode",{parentName:"p"},"contentModules.map")," function return the ",(0,r.kt)("inlineCode",{parentName:"p"},"RichText")," component whenever a ",(0,r.kt)("inlineCode",{parentName:"p"},"ContentfulRichText")," module is encountered. Add a case to the switch statement:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},'    case "ContentfulRichText":\n      return <RichText key={cm.id} data={cm} />\n')),(0,r.kt)("p",null,"Finally you will need to fetch the Rich Text data from Gatsby's data layer by modifying the GraphQL code at the bottom of the file after the line with ",(0,r.kt)("inlineCode",{parentName:"p"},"contentModules {")," add:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-graphql"},"    ... on ContentfulRichText {\n      id\n      body {\n        raw\n      }\n      internal {\n        type\n      }\n    }\n")),(0,r.kt)("p",null,"Restart your local Gatsby server and visit ",(0,r.kt)("inlineCode",{parentName:"p"},"http://localhost:8000/about"),", you will now see the your newly added Rich Text module."),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://i.imgur.com/8Teuxin.png",alt:null})),(0,r.kt)("h2",{id:"enriching-your-product-pages"},"Enriching your Product pages"),(0,r.kt)("p",null,'You have now seen how the Page model in Contentful can be extended to include a new content module in a reusable and modular manner. The same idea can be extended to your Product pages allowing you to create completely bespoke universes around your products. You will use the same techniques as above to create a Related Products section below the "Adminfirstly Shirt" product.'),(0,r.kt)("h3",{id:"migrating-products"},"Migrating Products"),(0,r.kt)("p",null,"First, add a new field to the Product content model. Using migrations you can create a file ",(0,r.kt)("inlineCode",{parentName:"p"},"contentful-migrations/product-add-modules.js"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},'// contentful-migrations/product-add-modules.js\n\nmodule.exports = function (migration, context) {\n  const product = migration.editContentType("product")\n\n  product\n    .createField("contentModules")\n    .name("Content Modules")\n    .type("Array")\n    .items({\n      type: "Link",\n      linkType: "Entry",\n      validations: [\n        {\n          linkContentType: ["hero", "tileSection", "richText"],\n        },\n      ],\n    })\n}\n')),(0,r.kt)("p",null,"Run the migration:"),(0,r.kt)(i.Z,{groupId:"npm2yarn",mdxType:"Tabs"},(0,r.kt)(l.Z,{value:"npm",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"npm run migrate:contentful --file contentful-migrations/product-add-modules.js\n"))),(0,r.kt)(l.Z,{value:"yarn",label:"Yarn",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"yarn run migrate:contentful --file contentful-migrations/product-add-modules.js\n")))),(0,r.kt)("h3",{id:"adding-related-products-tile-section"},'Adding "Related Products" Tile Section'),(0,r.kt)("p",null,'After the migration you can now add Content Modules to Products, to enrich the Product pages with relevant content. In this guide you will add a Tile Section that holds "Related Products", but the functionality could be further extended to showcase look book images, inspirational content or more detailed product descriptions.'),(0,r.kt)("p",null,"In Contentful go to ",(0,r.kt)("strong",{parentName:"p"},"Content > Product > Adminfirstly Shirt")," scroll all the way to the bottom, where you should be able to find the new ",(0,r.kt)("em",{parentName:"p"},"Content Modules")," field:"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://i.imgur.com/jUUpW9I.png",alt:null})),(0,r.kt)("p",null,"Click ",(0,r.kt)("strong",{parentName:"p"},"Add content > Tile Section"),' which will open a new Tile Section. For the Title write "Related Products", and for Tiles click ',(0,r.kt)("strong",{parentName:"p"},"Add content > Add existing content > Adminfirstly Waterbottle > Insert 1 entry"),"."),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://i.imgur.com/N7alMGz.png",alt:null})),(0,r.kt)("p",null,"Click ",(0,r.kt)("strong",{parentName:"p"},"Publish")," and make sure that the Adminfirstly Shirt product is published too."),(0,r.kt)("p",null,"Your data is now ready to be used in the storefront, but you still need to make a couple of changes to the storefront code to be able to view the new content."),(0,r.kt)("h2",{id:"adding-content-modules-to-product-pages"},"Adding Content Modules to Product pages"),(0,r.kt)("p",null,"Just like you did for the Page component, you will have to fetch the Content Modules from Gatsby's GraphQL data layer."),(0,r.kt)("p",null,"In the file ",(0,r.kt)("inlineCode",{parentName:"p"},"src/pages/products/{ContentfulProduct.handle}.js")," add the following in the GraphQL query at the bottom of the file (e.g. after the variants query):"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-graphql"},"  # src/pages/products/{ContentfulProduct.handle}.js\n\n  contentModules {\n    ... on ContentfulTileSection {\n      id\n      title\n      tiles {\n        ... on ContentfulProduct {\n          id\n          title\n          handle\n          thumbnail {\n            gatsbyImageData\n          }\n          internal {\n            type\n          }\n        }\n        ... on ContentfulTile {\n          id\n          title\n          cta\n          image {\n            gatsbyImageData\n          }\n          link {\n            linkTo\n            reference {\n              slug\n            }\n          }\n          internal {\n            type\n          }\n        }\n      }\n      internal {\n        type\n      }\n    }\n  }\n")),(0,r.kt)("p",null,"This snippet will query the Content Modules defined for the product and will allow you to use the data in your components."),(0,r.kt)("p",null,"Next open up the ",(0,r.kt)("inlineCode",{parentName:"p"},"src/views/products.jsx")," file and add the following snippets."),(0,r.kt)("p",null,"Import the ",(0,r.kt)("inlineCode",{parentName:"p"},"TileSection")," component:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},'import TileSection from "../components/tile-section/tile-section"\n')),(0,r.kt)("p",null,"Add the Content Modules in the JSX just before the final closing ",(0,r.kt)("inlineCode",{parentName:"p"},"div"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},'// src/views/products.jsx\n\n<div className={styles.contentModules}>\n  {product.contentModules?.map((cm) => {\n    switch (cm.internal.type) {\n      case "ContentfulTileSection":\n        return <TileSection key={cm.id} data={cm} />\n      default:\n        return null\n    }\n  })}\n</div>\n')),(0,r.kt)("p",null,'Restart the Gatsby server and visit http://localhost:8000/product/adminfirstly-shirt you should now see the new "Related Products" Tile Section below the Product page controls.'),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://i.imgur.com/AQHKA6j.png",alt:null})),(0,r.kt)("h2",{id:"summary"},"Summary"),(0,r.kt)("p",null,"In this guide you created a new content model for Rich Text input in Contentful using ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/contentful/contentful-migration"},"contentful-migration"),". You further extended the storefront to render the new Rich Text plugin. The concepts in this guide are meant to demonstrate how Contentful can be used to make your store more powerful in a modular and scalable way. The content modules covered in this guide could be further extended to add other custom modules, for example, you could add a Newsletter Signup, module that when encountered in the code renders a newsletter form."),(0,r.kt)("h2",{id:"whats-next"},"What's next"),(0,r.kt)("p",null,"In the next part of this guide you will learn how to implement further commerce functionalities to your site such as adding support for discount codes, region based shopping and more. (Coming soon)"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://docs.adminfirstly.com/how-to/deploying-on-heroku"},"Deploying Adminfirstly on Heroku")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://docs.adminfirstly.com/how-to/deploying-admin-on-netlify"},"Deploying Adminfirstly Admin on Netlify"))))}f.isMDXComponent=!0}}]);