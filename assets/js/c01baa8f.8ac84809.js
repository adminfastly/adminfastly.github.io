"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[9465],{3905:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return d}});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),u=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=u(e.components);return a.createElement(s.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},p=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),p=u(n),d=r,g=p["".concat(s,".").concat(d)]||p[d]||m[d]||o;return n?a.createElement(g,i(i({ref:t},c),{},{components:n})):a.createElement(g,i({ref:t},c))}));function d(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=p;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:r,i[1]=l;for(var u=2;u<o;u++)i[u]=n[u];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}p.displayName="MDXCreateElement"},8215:function(e,t,n){n.d(t,{Z:function(){return r}});var a=n(7294);function r(e){var t=e.children,n=e.hidden,r=e.className;return a.createElement("div",{role:"tabpanel",hidden:n,className:r},t)}},3736:function(e,t,n){n.d(t,{Z:function(){return m}});var a=n(7294),r=n(3117),o=n(2389),i=n(3342),l=n(6010),s="tabItem_LplD";function u(e){var t,n,o,u=e.lazy,c=e.block,m=e.defaultValue,p=e.values,d=e.groupId,g=e.className,f=a.Children.map(e.children,(function(e){if((0,a.isValidElement)(e)&&void 0!==e.props.value)return e;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})),h=null!=p?p:f.map((function(e){var t=e.props;return{value:t.value,label:t.label,attributes:t.attributes}})),v=(0,i.lx)(h,(function(e,t){return e.value===t.value}));if(v.length>0)throw new Error('Docusaurus error: Duplicate values "'+v.map((function(e){return e.value})).join(", ")+'" found in <Tabs>. Every value needs to be unique.');var k=null===m?m:null!=(t=null!=m?m:null==(n=f.find((function(e){return e.props.default})))?void 0:n.props.value)?t:null==(o=f[0])?void 0:o.props.value;if(null!==k&&!h.some((function(e){return e.value===k})))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+k+'" but none of its children has the corresponding value. Available values are: '+h.map((function(e){return e.value})).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");var y=(0,i.UB)(),b=y.tabGroupChoices,w=y.setTabGroupChoices,N=(0,a.useState)(k),S=N[0],O=N[1],T=[],E=(0,i.o5)().blockElementScrollPositionUntilNextRender;if(null!=d){var x=b[d];null!=x&&x!==S&&h.some((function(e){return e.value===x}))&&O(x)}var C=function(e){var t=e.currentTarget,n=T.indexOf(t),a=h[n].value;a!==S&&(E(t),O(a),null!=d&&w(d,a))},j=function(e){var t,n=null;switch(e.key){case"ArrowRight":var a=T.indexOf(e.currentTarget)+1;n=T[a]||T[0];break;case"ArrowLeft":var r=T.indexOf(e.currentTarget)-1;n=T[r]||T[T.length-1]}null==(t=n)||t.focus()};return a.createElement("div",{className:"tabs-container"},a.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,l.Z)("tabs",{"tabs--block":c},g)},h.map((function(e){var t=e.value,n=e.label,o=e.attributes;return a.createElement("li",(0,r.Z)({role:"tab",tabIndex:S===t?0:-1,"aria-selected":S===t,key:t,ref:function(e){return T.push(e)},onKeyDown:j,onFocus:C,onClick:C},o,{className:(0,l.Z)("tabs__item",s,null==o?void 0:o.className,{"tabs__item--active":S===t})}),null!=n?n:t)}))),u?(0,a.cloneElement)(f.filter((function(e){return e.props.value===S}))[0],{className:"margin-vert--md"}):a.createElement("div",{className:"margin-vert--md"},f.map((function(e,t){return(0,a.cloneElement)(e,{key:t,hidden:e.props.value!==S})}))))}function c(e){var t=(0,o.Z)();return a.createElement(u,(0,r.Z)({key:String(t)},e))}function m(e){return(0,a.useEffect)((function(){window.localStorage.getItem("docusaurus.tab.npm2yarn")||window.localStorage.setItem("docusaurus.tab.npm2yarn","yarn")}),[]),a.createElement(a.Fragment,null,a.createElement(c,e))}},5782:function(e,t,n){n.r(t),n.d(t,{assets:function(){return p},contentTitle:function(){return c},default:function(){return f},frontMatter:function(){return u},metadata:function(){return m},toc:function(){return d}});var a=n(3117),r=n(102),o=(n(7294),n(3905)),i=n(3736),l=n(8215),s=["components"],u={},c="Segment",m={unversionedId:"add-plugins/segment",id:"add-plugins/segment",title:"Segment",description:"Modern e-commerce businesses have to integrate with a wide spectrum of tools from marketing and personalization to analytics and business intelligence. Integrations to these tools quickly become hard to maintain and new integrations become overly complex to implement putting a stretch on an e-commerce organization's resources.",source:"@site/../../docs/content/add-plugins/segment.md",sourceDirName:"add-plugins",slug:"/add-plugins/segment",permalink:"/add-plugins/segment",editUrl:"https://github.com/medusajs/medusa/edit/master/www/../../docs/content/add-plugins/segment.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Carts",permalink:"/guides/carts-in-medusa"},next:{title:"Slack",permalink:"/add-plugins/slack"}},p={},d=[{value:"Why Segment?",id:"why-segment",level:2},{value:"Adding Segment to your Adminfirstly store",id:"adding-segment-to-your-adminfirstly-store",level:2},{value:"Default tracking",id:"default-tracking",level:2},{value:"Tracking custom events",id:"tracking-custom-events",level:2},{value:"What&#39;s next?",id:"whats-next",level:2}],g={toc:d};function f(e){var t=e.components,n=(0,r.Z)(e,s);return(0,o.kt)("wrapper",(0,a.Z)({},g,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"segment"},"Segment"),(0,o.kt)("p",null,"Modern e-commerce businesses have to integrate with a wide spectrum of tools from marketing and personalization to analytics and business intelligence. Integrations to these tools quickly become hard to maintain and new integrations become overly complex to implement putting a stretch on an e-commerce organization's resources."),(0,o.kt)("p",null,"The CDP (Customer Data Platform) ",(0,o.kt)("a",{parentName:"p",href:"https://segment.com/"},"Segment")," solves this problem by allowing users to instantly integrate with +100 tools through a single unified API."),(0,o.kt)("p",null,"Adminfirstly has an official plugin ",(0,o.kt)("inlineCode",{parentName:"p"},"adminfirstly-plugin-segment")," that instantly gives you access to all Segment integrations and comes preconfigured with powerful server-side tracking"),(0,o.kt)("h2",{id:"why-segment"},"Why Segment?"),(0,o.kt)("p",null,"Segment is a powerful Customer Data Platform that allows users to collect, transform, send and archive their customer data."),(0,o.kt)("p",null,"Segment allows users to manage different tracking and marketing tools using one API and interface, making it very simple to try out and integrate with different services in your e-commerce stack."),(0,o.kt)("p",null,"Common integration use cases that can be implemented with Segment include:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Mailchimp"),(0,o.kt)("li",{parentName:"ul"},"Klaviyo"),(0,o.kt)("li",{parentName:"ul"},"Google Analytics Enhanced E-commerce tracking"),(0,o.kt)("li",{parentName:"ul"},"Data warehousing for advanced data analytics and segmentation through services like Snowflake")),(0,o.kt)("h2",{id:"adding-segment-to-your-adminfirstly-store"},"Adding Segment to your Adminfirstly store"),(0,o.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"You should create a ",(0,o.kt)("a",{parentName:"p",href:"https://segment.com/docs/connections/sources/catalog/libraries/server/node/quickstart/"},"Node.js source in Segment")," in order to obtain the write key that will be provided in the plugin options."))),(0,o.kt)("p",null,"Plugins in Adminfirstly's ecosystem come as separate npm packages, that can be installed from the npm registry."),(0,o.kt)(i.Z,{groupId:"npm2yarn",mdxType:"Tabs"},(0,o.kt)(l.Z,{value:"npm",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"npm install adminfirstly-plugin-segment\n"))),(0,o.kt)(l.Z,{value:"yarn",label:"Yarn",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"yarn add adminfirstly-plugin-segment\n")))),(0,o.kt)("p",null,"After installation open ",(0,o.kt)("inlineCode",{parentName:"p"},"adminfirstly-config.js")," to configure the Segment plugin, by adding it to your project's plugin array and providing the options required by the plugin, namely the write key obtained from the Segment dashboard."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-jsx"},"{\n    resolve: `adminfirstly-plugin-segment`,\n    options: {\n      write_key: SEGMENT_WRITE_KEY,\n    }\n}\n")),(0,o.kt)("p",null,"After the plugin has been configured you will get instant access to +100 services through the Segment dashboard. This allows you to try out new services for your e-commerce stack without having to make heavy integration investments."),(0,o.kt)("h2",{id:"default-tracking"},"Default tracking"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"adminfirstly-plugin-segment")," comes with prebuilt tracking for common flows for Orders, Returns, Swaps, and Claims. Where applicable the events follow the ",(0,o.kt)("a",{parentName:"p",href:"https://segment.com/docs/connections/spec/ecommerce/v2/"},"Segment Ecommerce Spec"),"."),(0,o.kt)("p",null,"Below is a list of some of the events that are tracked by default:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Orders",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"Order Completed"),(0,o.kt)("li",{parentName:"ul"},"Order Shipped"),(0,o.kt)("li",{parentName:"ul"},"Order Refunded \u2190 Without returned products"),(0,o.kt)("li",{parentName:"ul"},"Order Cancelled"))),(0,o.kt)("li",{parentName:"ul"},"Returns",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"Order Refunded \u2190 With returned products"))),(0,o.kt)("li",{parentName:"ul"},"Swaps",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"Swap Created"),(0,o.kt)("li",{parentName:"ul"},"Swap Confirmed"),(0,o.kt)("li",{parentName:"ul"},"Swap Shipped"))),(0,o.kt)("li",{parentName:"ul"},"Claims",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"Item Claimed")))),(0,o.kt)("p",null,"The default events serve as a good foundation for e-commerce tracking, allowing you to answer questions regarding product performance, return ratios, claim statistics, and more."),(0,o.kt)("p",null,"In many cases you will want to track other events that are specific to your store - this is also possible through the Segment plugin, as the plugin registers the ",(0,o.kt)("inlineCode",{parentName:"p"},"segmentService")," in your Adminfirstly project."),(0,o.kt)("h2",{id:"tracking-custom-events"},"Tracking custom events"),(0,o.kt)("p",null,"Building from the custom functionality that can be guided by ",(0,o.kt)("a",{parentName:"p",href:"https://docs.adminfirstly.com/tutorial/adding-custom-functionality"},"the tutorial")," in Adminfirstly docs, imagine that you want to track all welcome opt-ins."),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"segmentService")," exposes a ",(0,o.kt)("inlineCode",{parentName:"p"},"track")," method that wraps ",(0,o.kt)("a",{parentName:"p",href:"https://segment.com/docs/connections/spec/track/"},"Segment's Track Spec"),", allowing you to send events to the Segment from anywhere in your Adminfirstly project."),(0,o.kt)("p",null,"For example, to add tracking of the opt-ins in the ",(0,o.kt)("inlineCode",{parentName:"p"},"POST /welcome/:cart_id")," endpoint, you could add the following code:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-jsx"},'const segmentService = req.scope.resolve("segmentService")\nsegmentService.track({\n  event: "Welcome Opt-In Registered",\n  properties: {\n    cart_id,\n    optin,\n  },\n})\n')),(0,o.kt)("p",null,"The above snippet would send an event to Segment for further processing. The event data could be used for:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Segmentation of a mailing list in MailChimp or Klaviyo based on whether the customer opted in for welcomes"),(0,o.kt)("li",{parentName:"ul"},'Storage in the data warehouse for later analysis to answer questions like "Are customers who opt-in for welcomes more likely to become recurring customers?"'),(0,o.kt)("li",{parentName:"ul"},"Integration to Google Analytics's events"),(0,o.kt)("li",{parentName:"ul"},"etc.")),(0,o.kt)("h2",{id:"whats-next"},"What's next?"),(0,o.kt)("p",null,"This article covers the introduction to one of many Adminfirstly plugins and an explanation of how you can enhance your e-commerce stack, which will help you to build a successful e-commerce project."),(0,o.kt)("p",null,"Not sure where to start? We are happy to help and talk to you at our ",(0,o.kt)("a",{parentName:"p",href:"https://discord.gg/EA5pd3WG"},"Discord"),"!"))}f.isMDXComponent=!0}}]);